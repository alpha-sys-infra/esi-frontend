webpackJsonp([3],{1113:function(e,t,n){"use strict";var a=n(1114),i=n(1115),r=n(1116),o=n(1117);t.a={searchSchema:a.a,searchUiSchema:i.a,editSchema:r.a,editUiSchema:o.a}},1114:function(e,t,n){"use strict";t.a={$id:"function-search-schema",title:"function-search-schema",description:"function-search-schema.",type:"object",required:[],properties:{module:{type:"string",title:"模块名称"},name:{type:"string",title:"功能名称"},code:{type:"string",title:"功能编码"}}}},1115:function(e,t,n){"use strict";t.a={module:{"ui:widget":"input","ui:options":{type:"text",placeholder:"模块模糊查询"},"ui:title":"模块名称","ui:description":""},name:{"ui:widget":"input","ui:options":{type:"text",placeholder:"功能模糊查询"},"ui:title":"功能名称","ui:description":""},code:{"ui:widget":"input","ui:options":{type:"text",placeholder:"编码模糊查询"},"ui:title":"模块编码","ui:description":""}}},1116:function(e,t,n){"use strict";t.a={$id:"function-edit-schema",title:"function-edit-schema",description:"function-edit-schema.",type:"object",required:["moduleId","name","code"],properties:{id:{type:"string"},moduleId:{type:"string",title:"模块Id",description:"相关菜单模块"},module:{type:"string",title:"模块名称"},name:{type:"string",title:"功能名称",maxLength:25,minLength:1},code:{type:"string",title:"功能编码",maxLength:25,minLength:1},description:{type:"string",title:"功能描述",maxLength:300}}}},1117:function(e,t,n){"use strict";t.a={name:{"ui:widget":"input","ui:options":{type:"text",placeholder:""},"ui:rules":[{required:!0,message:"请输入功能名称"},{max:25,message:"最多输入25字符"}],"ui:title":"功能名称","ui:description":"","ui:formItemConfig":{hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:16}}},code:{"ui:widget":"input","ui:options":{type:"text",placeholder:""},"ui:rules":[{required:!0,message:"请输入功能编码"},{max:25,message:"最多输入25字符"}],"ui:title":"功能编码","ui:description":"","ui:formItemConfig":{hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:16}}},description:{"ui:widget":"input.textarea","ui:options":{style:{width:400,height:200},autoSize:{minRows:2,maxRows:6},placeholder:""},"ui:rules":[{max:300,message:"最多输入300字符!"}],"ui:title":"功能描述","ui:description":"","ui:formItemConfig":{hasFeedback:!0,labelCol:{span:6},wrapperCol:{span:16}}},moduleId:{"ui:widget":"cascader","ui:options":{fieldNames:{label:"title",value:"id",children:"children"},options:[]},"ui:rules":[{required:!0,message:"请选择模块!"}],"ui:remoteConfig":{apiKey:"getAllMenu",hand:function(e){return e}},"ui:title":"模块","ui:formItemConfig":{hasFeedback:!0,label:"模块",labelCol:{span:6},wrapperCol:{span:16}}}}},891:function(e,t,n){"use strict";function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(i,r){try{var o=t[i](r),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(875),c=(n.n(s),n(876)),l=n.n(c),u=n(867),d=(n.n(u),n(868)),p=n.n(d),m=n(873),h=(n.n(m),n(874)),f=n.n(h),g=n(78),y=n.n(g),b=n(877),S=(n.n(b),n(878)),v=n.n(S),w=n(869),x=(n.n(w),n(870)),C=n.n(x),F=n(47),O=(n.n(F),n(39)),k=n.n(O),E=n(0),I=n.n(E),j=n(79),R=n(871),_=n(879),z=n(1113),D=n(882),M=n(306),L=n(175),P=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),T={display:"none"},K=function(e){function t(){var e,n,o,s,c=this;i(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return n=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),o.state={filter:{module:"",name:"",code:""},expand:!0,selectedRowKeys:[],pagedList:[],pagination:{current:1,pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e){return"Total "+e+" items"}},sorter:{field:"",order:""},loading:!1,editModalVisible:!1},o.columns=[{title:"模块名称",dataIndex:"module",sorter:!0},{title:"功能名称",dataIndex:"name",sorter:!0},{title:"功能编码",dataIndex:"code",sorter:!0},{title:"操作",dataIndex:"id",fixed:"right",width:180,render:function(e,t){return I.a.createElement("div",null,I.a.createElement(k.a,{type:"link",onClick:function(){return o.editFunction(t)}},"编辑"),I.a.createElement(C.a,{type:"vertical"}),I.a.createElement(v.a,{title:"确定删除?",onConfirm:function(){return o.delFunction(t.id)}},I.a.createElement(k.a,{type:"link"},"删除")))}}],o.editFormData={},o.fetch=a(y.a.mark(function e(){var t,n,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.setState({loading:!0}),e.next=3,Object(j.getFunctionPagedList)(i);case 3:t=e.sent,n=t.data,a=Object.assign({},o.state.pagination),a.total=n.totalCount,o.setState({loading:!1,pagedList:n.rows,pagination:a});case 8:case"end":return e.stop()}},e,c)})),o.handleTableChange=function(e,t,n){var a=Object.assign({},o.state.pagination);a.current=e.current,a.pageSize=e.pageSize,o.setState({pagination:a,sorter:{field:n.field,order:n.order}});var i={pageIndex:a.current,pageSize:a.pageSize,sortBy:n.field,descending:"descend"===n.order,filter:o.state.filter};o.fetch(i)},o.handleSearch=function(e){var t=Object.assign({},o.state.pagination);t.current=1,o.setState({filter:e,pagination:t});var n={pageIndex:1,pageSize:o.state.pagination.pageSize,sortBy:o.state.sorter.field,descending:"descend"===o.state.sorter.order,filter:e};o.fetch(n)},o.handleReset=function(){o.setState({filter:{}})},o.onSelectChange=function(e){o.setState({selectedRowKeys:e})},o.delFunction=function(){var e=a(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.delFunction)({id:t});case 3:f.a.success({placement:"bottomLeft bottomRight",message:"删除成功"}),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:o.refresh();case 9:case"end":return e.stop()}},e,c,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),o.batchDelFunction=a(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.delFunctions)({ids:JSON.stringify(o.state.selectedRowKeys.map(function(e){return e}))});case 3:o.setState({selectedRowKeys:[]}),f.a.success({placement:"bottomLeft bottomRight",message:"删除成功"}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:o.refresh();case 10:case"end":return e.stop()}},e,c,[[0,7]])})),o.addFunction=function(){o.editFormData={},o.setState({editModalVisible:!0})},o.editFunction=function(e){var t=M.a.getData(z.a.editSchema.$id+"_moduleId"),n=L.a.openTreeData(t),a=L.a.getTreeEleWithParent(e.moduleId,n),i=a.map(function(e){return e.id});o.editFormData=Object.assign({},e,{moduleId:i}),o.setState({editModalVisible:!0})},o.saveFunction=function(){var e=a(y.a.mark(function e(t){var n,a,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.assign({},o.editFormData,t),a=M.a.getData(z.a.editSchema.$id+"_moduleId"),n.moduleId=n.moduleId[n.moduleId.length-1],i=L.a.getTreeEleByPropertyValue(n.moduleId,"id",a),n.module=i.title,e.prev=5,e.next=8,Object(j.saveFunction)(n);case 8:o.setState({editModalVisible:!1}),f.a.success({placement:"bottomLeft bottomRight",message:"保存成功"}),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(5);case 14:o.refresh();case 15:case"end":return e.stop()}},e,c,[[5,12]])}));return function(t){return e.apply(this,arguments)}}(),o.editModalOnOk=function(){o.editFunctionForm.handleSubmit()},o.editModalOnCancel=function(){o.setState({editModalVisible:!1})},o.refresh=function(){var e={pageIndex:o.state.pagination.current,pageSize:o.state.pagination.pageSize,sortBy:o.state.sorter.field,descending:"descend"===o.state.sorter.order,filter:o.state.filter};o.fetch(e)},s=n,r(o,s)}return o(t,e),P(t,[{key:"componentDidMount",value:function(){this.fetch({pageIndex:this.state.pagination.current,pageSize:this.state.pagination.pageSize,filter:this.state.filter})}},{key:"render",value:function(){var e=this;console.log("Function render");var t=this.state.selectedRowKeys,n={selectedRowKeys:t,onChange:this.onSelectChange},a=t.length>0;return I.a.createElement("div",null,I.a.createElement(R.a,{schema:z.a.searchSchema,uiSchema:z.a.searchUiSchema,handleSubmit:this.handleSearch,handleReset:this.handleReset}),I.a.createElement(C.a,null),I.a.createElement("div",{style:{marginBottom:16}},I.a.createElement(D.a,{permission:["function_edit"]},I.a.createElement(k.a,{type:"primary",icon:"plus-square-o",onClick:this.addFunction},"新增")),I.a.createElement(C.a,{type:"vertical"}),I.a.createElement(D.a,{permission:["function_del"]},I.a.createElement(v.a,{title:"确定删除?",onConfirm:this.batchDelFunction},I.a.createElement(k.a,{type:"danger",disabled:!a,icon:"delete"},"删除")))),I.a.createElement(p.a,{rowSelection:n,columns:this.columns,rowKey:function(e){return e.id},dataSource:this.state.pagedList,pagination:this.state.pagination,loading:this.state.loading,onChange:this.handleTableChange,scroll:{x:768},bordered:!0}),I.a.createElement(l.a,{visible:this.state.editModalVisible,cancelText:"关闭",okText:"提交",title:this.editFormData.id?"编辑功能":"新增功能",onCancel:this.editModalOnCancel,onOk:this.editModalOnOk,destroyOnClose:!0},I.a.createElement(_.a,{ref:function(t){e.editFunctionForm=t},schema:z.a.editSchema,uiSchema:z.a.editUiSchema,formData:this.editFormData,handleSubmit:this.saveFunction})),I.a.createElement(_.a,{schema:z.a.editSchema,uiSchema:z.a.editUiSchema,style:T}))}}]),t}(I.a.PureComponent);t.default=K}});
//# sourceMappingURL=3.963c1462.chunk.js.map