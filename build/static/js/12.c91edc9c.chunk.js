webpackJsonp([12],{1118:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=a(875),c=(a.n(i),a(876)),s=a.n(c),l=a(0),u=a.n(l),d=a(879),f=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),h=function(e){function t(){var e,a,o,i;n(this,t);for(var c=arguments.length,s=Array(c),l=0;l<c;l++)s[l]=arguments[l];return a=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.onCancel=function(){o.props.onCancel()},o.onOk=function(){o.editForm.handleSubmit()},i=a,r(o,i)}return o(t,e),f(t,[{key:"render",value:function(){var e=this;return u.a.createElement(s.a,{visible:this.props.visible,cancelText:"关闭",okText:"提交",title:this.props.title,onCancel:this.onCancel,onOk:this.onOk,destroyOnClose:!0},u.a.createElement(d.a,{ref:function(t){e.editForm=t},schema:this.props.schema,uiSchema:this.props.uiSchema,formData:this.props.formData,handleSubmit:this.props.handFormSubmit}))}}]),t}(u.a.PureComponent);t.a=h},892:function(e,t,a){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){function n(r,o){try{var i=t[r](o),c=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(c).then(function(e){n("next",e)},function(e){n("throw",e)});e(c)}return n("next")})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=a(867),s=(a.n(c),a(868)),l=a.n(s),u=a(47),d=(a.n(u),a(39)),f=a.n(d),h=a(78),p=a.n(h),b=a(873),m=(a.n(b),a(874)),g=a.n(m),y=a(877),v=(a.n(y),a(878)),S=a.n(v),w=a(869),O=(a.n(w),a(870)),R=a.n(O),P=a(0),x=a.n(P),C=a(79),j=a(871),E=a(883),k=a(1118),_=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),F=function(e){function t(){var e,a,i,c,s=this;r(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return a=i=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),i.state={tableFilter:{name:"",code:""},searchFormExpand:!0,tableSelectedRowKeys:[],tablePagedList:[],tablePagination:{current:1,pageSize:10,showQuickJumper:!0,showSizeChanger:!0,showTotal:function(e){return"Total "+e+" items"}},tableSorter:{field:"",order:""},tableLoading:!1,editModalVisible:!1},i.columns=[{title:"角色名称",dataIndex:"name",sorter:!0},{title:"角色编码",dataIndex:"code",sorter:!0},{title:"操作",dataIndex:"id",fixed:"right",width:120,render:function(e,t){return x.a.createElement("div",null,x.a.createElement("a",{href:"javascript:;",onClick:function(){return i.editRole(t)}},"编辑"),x.a.createElement(R.a,{type:"vertical"}),x.a.createElement(S.a,{title:"确定删除?",onConfirm:function(){return i.delRole(t.id)}},x.a.createElement("a",{href:"javascript:;"},"删除")))}}],i.editFormData={},i.handleSearch=function(e){var t=Object.assign({},i.state.tablePagination);t.current=1,i.setState({tableFilter:e,tablePagination:t});var a={pageIndex:1,pageSize:i.state.tablePagination.pageSize,sortBy:i.state.tableSorter.field,descending:"descend"===i.state.tableSorter.order,filter:e};i.fetch(a)},i.handleReset=function(){i.setState({tableFilter:{}})},i.handleTableChange=function(e,t,a){var n=Object.assign({},i.state.tablePagination);n.current=e.current,n.pageSize=e.pageSize,i.setState({tablePagination:n,tableSorter:{field:a.field,order:a.order}});var r={pageIndex:n.current,pageSize:n.pageSize,sortBy:a.field,descending:"descend"===a.order,filter:i.state.tableFilter};i.fetch(r)},i.onSelectChange=function(e){i.setState({tableSelectedRowKeys:e})},i.addRole=function(){i.editFormData={},i.setState({editModalVisible:!0})},i.batchDelRole=n(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(C.delRoles)({ids:JSON.stringify(i.state.tableSelectedRowKeys.map(function(e){return e}))});case 3:i.setState({tableSelectedRowKeys:[]}),g.a.success({placement:"bottomLeft bottomRight",message:"删除成功"}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:i.refresh();case 10:case"end":return e.stop()}},e,s,[[0,7]])})),i.editRole=function(e){i.editFormData=Object.assign({},e),i.setState({editModalVisible:!0})},i.delRole=function(){var e=n(p.a.mark(function e(t){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(C.delRole)({id:t});case 3:g.a.success({placement:"bottomLeft bottomRight",message:"删除成功"}),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:i.refresh();case 9:case"end":return e.stop()}},e,s,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),i.editModalOnCancel=function(){i.setState({editModalVisible:!1})},i.saveRole=function(){var e=n(p.a.mark(function e(t){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object.assign({},i.editFormData,t),e.prev=1,e.next=4,Object(C.saveRole)(a);case 4:i.setState({editModalVisible:!1}),g.a.success({placement:"bottomLeft bottomRight",message:"保存成功"}),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:i.refresh();case 11:case"end":return e.stop()}},e,s,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),i.refresh=function(){var e={pageIndex:i.state.tablePagination.current,pageSize:i.state.tablePagination.pageSize,sortBy:i.state.tableSorter.field,descending:"descend"===i.state.tableSorter.order,filter:i.state.tableFilter};i.fetch(e)},i.fetch=n(p.a.mark(function e(){var t,a,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.setState({tableLoading:!0}),e.next=3,Object(C.getRolePagedList)(r);case 3:t=e.sent,a=t.data,n=Object.assign({},i.state.tablePagination),n.total=a.totalCount,i.setState({tableLoading:!1,tablePagedList:a.rows,tablePagination:n});case 8:case"end":return e.stop()}},e,s)})),c=a,o(i,c)}return i(t,e),_(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){console.log("Role render");var e=this.state.tableSelectedRowKeys,t={selectedRowKeys:e,onChange:this.onSelectChange},a=e.length>0;return x.a.createElement("div",null,x.a.createElement(j.a,{schema:E.a.searchSchema,uiSchema:E.a.searchUiSchema,handleSubmit:this.handleSearch,handleReset:this.handleReset}),x.a.createElement(R.a,null),x.a.createElement("div",{style:{marginBottom:16}},x.a.createElement(f.a,{type:"primary",icon:"plus-square-o",onClick:this.addRole},"新增"),x.a.createElement(R.a,{type:"vertical"}),x.a.createElement(S.a,{title:"确定删除?",onConfirm:this.batchDelRole},x.a.createElement(f.a,{type:"danger",disabled:!a,icon:"delete"},"删除"))),x.a.createElement(l.a,{rowSelection:t,columns:this.columns,rowKey:function(e){return e.id},dataSource:this.state.tablePagedList,pagination:this.state.tablePagination,loading:this.state.tableLoading,onChange:this.handleTableChange,scroll:{x:768},bordered:!0}),x.a.createElement(k.a,{visible:this.state.editModalVisible,title:this.editFormData.id?"编辑":"新增",onCancel:this.editModalOnCancel,destroyOnClose:!0,schema:E.a.editSchema,uiSchema:E.a.editUiSchema,formData:this.editFormData,handFormSubmit:this.saveRole}))}}]),t}(x.a.PureComponent);t.default=F}});
//# sourceMappingURL=12.c91edc9c.chunk.js.map